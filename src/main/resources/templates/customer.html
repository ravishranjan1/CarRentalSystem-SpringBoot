<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <title>Rentify | Customers</title>

    <!-- Font Awesome -->
    <link rel="stylesheet"
          href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css"/>

    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700&display=swap" rel="stylesheet">

    <style>
        *{
            margin:0;
            padding:0;
            box-sizing:border-box;
            font-family: 'Poppins', sans-serif;
        }

        body{
            background: linear-gradient(135deg, #f7f9fc, #eef3ff);
            color:#0f172a;
        }

        /* Navbar */
        .navbar{
            background: linear-gradient(90deg, #0f172a, #1e293b);
            padding: 14px 30px;
            display:flex;
            justify-content:space-between;
            align-items:center;
            position: sticky;
            top: 0;
            z-index: 999;
            box-shadow: 0 8px 22px rgba(0,0,0,0.15);
            height: 70px;
        }

        .logo{
            display:flex;
            align-items:center;
            gap:10px;
            cursor:pointer;
        }

        .logo h2{
            color:white;
            font-size:20px;
            font-weight:700;
            letter-spacing:1px;
        }

        .logo span{
            color:#facc15;
        }

        /* ‚úÖ Bigger App Logo (Height + Width increase) */
        .app-logo{
          height: 58px;
          width: 58px;
          border-radius: 16px;
          object-fit: cover;

          /* navbar ke andar nicely fit */
          display:block;
        }

        .nav-links a{
            color: white;
            text-decoration:none;
            margin-left:18px;
            font-weight:500;
            font-size:14px;
            padding:8px 12px;
            border-radius:10px;
            transition:0.3s;
        }

        .nav-links a:hover{
            background: rgba(255,255,255,0.12);
            color:#facc15;
        }

        /* Main Container */
        .container{
            width:90%;
            margin: 25px auto;
        }

        .page-title{
            display:flex;
            justify-content:space-between;
            align-items:center;
            gap: 10px;
            flex-wrap: wrap;
        }

        .page-title h1{
            font-size: 26px;
            font-weight: 800;
            color:#0f172a;
        }

        .page-title p{
            font-size: 13px;
            color:#64748b;
            margin-top:5px;
        }

        /* Toast messages */
        .toast{
            padding:12px 16px;
            border-radius:12px;
            font-size:13px;
            font-weight:600;
            margin-top: 14px;
            box-shadow:0 8px 20px rgba(0,0,0,0.08);
            width: fit-content;
            animation: fadeIn 0.4s ease;
        }

        .toast.success{
            background: #dcfce7;
            color:#166534;
            border: 1px solid #86efac;
        }

        .toast.error{
            background: #fee2e2;
            color:#991b1b;
            border: 1px solid #fecaca;
        }

        @keyframes fadeIn {
            from {opacity:0; transform: translateY(-8px);}
            to {opacity:1; transform: translateY(0);}
        }

        /* Stats Cards */
        .stats{
            margin-top: 22px;
            display:grid;
            grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
            gap: 16px;
        }

        .stat-card{
            background:white;
            padding:18px;
            border-radius:18px;
            box-shadow:0 6px 18px rgba(0,0,0,0.08);
            border:1px solid rgba(0,0,0,0.05);
            transition:0.3s;
        }

        .stat-card:hover{
            transform: translateY(-5px);
            box-shadow:0 12px 28px rgba(0,0,0,0.14);
        }

        .stat-card .top{
            display:flex;
            justify-content:space-between;
            align-items:center;
        }

        .stat-icon{
            width:46px;
            height:46px;
            border-radius:16px;
            display:flex;
            justify-content:center;
            align-items:center;
            color:white;
            font-size:18px;
            box-shadow:0 8px 18px rgba(0,0,0,0.12);
        }

        .bg-green{ background: linear-gradient(135deg, #22c55e, #16a34a); }
        .bg-blue{ background: linear-gradient(135deg, #3b82f6, #2563eb); }
        .bg-orange{ background: linear-gradient(135deg, #f97316, #ea580c); }

        .stat-card h3{
            margin-top:10px;
            color:#334155;
            font-size:14px;
            font-weight:600;
        }

        .stat-card h2{
            font-size:26px;
            font-weight:800;
            margin-top:6px;
        }

        .stat-card small{
            display:block;
            margin-top:5px;
            font-size:12px;
            color:#64748b;
        }

        /* Actions Bar */
        .actions-bar{
            margin-top: 25px;
            display:flex;
            justify-content:space-between;
            align-items:center;
            gap: 12px;
            flex-wrap: wrap;
        }

        .search-box{
            flex: 1;
            min-width: 260px;
            background:white;
            border-radius:14px;
            display:flex;
            align-items:center;
            padding:10px 14px;
            box-shadow:0 6px 18px rgba(0,0,0,0.08);
            border:1px solid rgba(0,0,0,0.05);
        }

        .search-box i{
            color:#64748b;
            margin-right:10px;
        }

        .search-box input{
            border:none;
            outline:none;
            width:100%;
            font-size:14px;
        }

        .btn{
            padding:11px 16px;
            border:none;
            cursor:pointer;
            border-radius:14px;
            font-weight:700;
            font-size:14px;
            transition:0.3s;
            display:flex;
            align-items:center;
            gap:8px;
            text-decoration:none;
        }

        .btn-primary{
            background: linear-gradient(135deg, #2563eb, #1d4ed8);
            color:white;
            box-shadow:0 8px 18px rgba(37,99,235,0.25);
        }

        .btn-primary:hover{
            transform: translateY(-2px);
            filter: brightness(1.05);
        }

        /* Table */
        .table-wrap{
            margin-top:20px;
            background:white;
            border-radius:18px;
            padding:18px;
            box-shadow:0 6px 18px rgba(0,0,0,0.08);
            border:1px solid rgba(0,0,0,0.05);
            overflow:auto;
        }

        table{
            width:100%;
            border-collapse: collapse;
            min-width: 800px;
        }

        th, td{
            padding:14px 12px;
            border-bottom:1px solid #e2e8f0;
            text-align:center;
            font-size:14px;
        }

        th{
            background: #0f172a;
            color:white;
            font-size:13px;
            letter-spacing:0.3px;
        }

        tr:hover td{
            background: #f8fafc;
        }

        .action-btns{
            display:flex;
            justify-content:center;
            align-items:center;
            gap: 10px;
        }

        .icon-btn{
            width:38px;
            height:38px;
            border-radius:12px;
            display:flex;
            justify-content:center;
            align-items:center;
            text-decoration:none;
            font-size:16px;
            transition:0.25s;
            border: 1px solid rgba(0,0,0,0.08);
        }

        .edit-btn{
            background:#e0f2fe;
            color:#0369a1;
        }

        .edit-btn:hover{
            transform: translateY(-2px);
            background:#bae6fd;
        }

        .delete-btn{
            background:#fee2e2;
            color:#991b1b;
            cursor:pointer;
        }

        .delete-btn:hover{
            transform: translateY(-2px);
            background:#fecaca;
        }

        /* Modal */
        .modal{
            display:none;
            position:fixed;
            z-index:2000;
            left:0; top:0;
            width:100%; height:100%;
            background: rgba(0,0,0,0.55);
            backdrop-filter: blur(6px);
        }

        .modal-content{
            background:white;
            width: 420px;
            max-width: 92%;
            margin: 7% auto;
            padding: 20px;
            border-radius:18px;
            box-shadow:0 12px 35px rgba(0,0,0,0.18);
            animation: pop 0.25s ease;
        }

        @keyframes pop{
            from{transform: scale(0.95); opacity:0;}
            to{transform: scale(1); opacity:1;}
        }

        .modal-top{
            display:flex;
            justify-content:space-between;
            align-items:center;
            margin-bottom: 10px;
        }

        .modal-top h2{
            font-size:18px;
            font-weight:800;
            color:#0f172a;
        }

        .close{
            cursor:pointer;
            font-size:24px;
            font-weight:800;
            color:#475569;
        }

        .close:hover{
            color:#ef4444;
        }

        .form-group{
            margin-top:12px;
        }

        .form-group label{
            font-size:13px;
            font-weight:600;
            color:#334155;
        }

        .form-group input{
            width:100%;
            padding:10px 12px;
            margin-top:6px;
            border-radius:12px;
            border:1px solid #cbd5e1;
            outline:none;
            font-size:14px;
        }

        .form-group input:focus{
            border:1px solid #2563eb;
            box-shadow:0 0 0 4px rgba(37,99,235,0.15);
        }

        .modal-actions{
            margin-top:16px;
            display:flex;
            justify-content:flex-end;
            gap: 10px;
        }

        .btn-secondary{
            background:#e2e8f0;
            color:#0f172a;
        }

        .btn-secondary:hover{
            transform: translateY(-2px);
            filter: brightness(1.05);
        }

        /* Responsive */
        @media(max-width:650px){
            .nav-links{
                display:none;
            }
        }
    </style>
</head>

<body>

<!-- Navbar -->
<div class="navbar">
    <div class="logo">
        <img th:src="@{/images/rentify.png}" class="app-logo" alt="Rentify Logo">
        <h2>Rent<span>ify</span></h2>
    </div>

    <div class="nav-links">
        <a href="/rentify/">üè† Dashboard</a>

    </div>
</div>

<div class="container">

    <!-- Page Header -->
    <div class="page-title">
        <div>
            <h1>Customers üë§</h1>
            <p>Manage all customer details in a clean and professional way.</p>
        </div>
    </div>

    <!-- Messages -->
    <div th:if="${success}" class="toast success">
        ‚úÖ <span th:text="${success}"></span>
    </div>

    <div th:if="${error}" class="toast error">
        ‚ùå <span th:text="${error}"></span>
    </div>

    <!-- Stats -->
    <div class="stats">
        <div class="stat-card">
            <div class="top">
                <div>
                    <h3>Total Customers</h3>
                    <h2 th:text="${#lists.size(customers)}">0</h2>
                    <small>Registered in system</small>
                </div>
                <div class="stat-icon bg-green"><i class="fa-solid fa-user"></i></div>
            </div>
        </div>

<!--        <div class="stat-card">-->
<!--            <div class="top">-->
<!--                <div>-->
<!--                    <h3>Active Customers</h3>-->
<!--                    <h2>&#45;&#45;</h2>-->
<!--                    <small>(You can make it dynamic later)</small>-->
<!--                </div>-->
<!--                <div class="stat-icon bg-blue"><i class="fa-solid fa-user-check"></i></div>-->
<!--            </div>-->
<!--        </div>-->

<!--        <div class="stat-card">-->
<!--            <div class="top">-->
<!--                <div>-->
<!--                    <h3>New Today</h3>-->
<!--                    <h2>&#45;&#45;</h2>-->
<!--                    <small>(Optional feature)</small>-->
<!--                </div>-->
<!--                <div class="stat-icon bg-orange"><i class="fa-solid fa-bolt"></i></div>-->
<!--            </div>-->
<!--        </div>-->
    </div>

    <!-- Actions Bar -->
    <div class="actions-bar">
        <div class="search-box">
            <i class="fa-solid fa-magnifying-glass"></i>
            <input id="searchInput" type="text" placeholder="Search by name, phone, license..." onkeyup="filterTable()">
        </div>

        <button class="btn btn-primary" onclick="location.href='/rentify/customer/new'">
            <i class="fa-solid fa-plus"></i> Add Customer
        </button>
    </div>

    <!-- Customers Table -->
    <div class="table-wrap">
        <table id="customerTable">
            <thead>
            <tr>
                <th>ID</th>
                <th>Name</th>
                <th>Phone</th>
                <th>Driving License No</th>
                <th>Action</th>
            </tr>
            </thead>

            <tbody>
            <tr th:each="c : ${customers}">
                <td th:text="${c.id}"></td>
                <td th:text="${c.name}"></td>
                <td th:text="${c.phone}"></td>
                <td th:text="${c.drivingLicenseNo}"></td>

                <td>
                    <div class="action-btns">
                        <a class="icon-btn edit-btn" th:href="@{/rentify/customer/edit/{id}(id=${c.id})}" title="Edit">
                            <i class="fa-solid fa-pen-to-square"></i>
                        </a>

                        <form th:action="@{/rentify/customer/delete/{id}(id=${c.id})}"
                              method="post"
                              style="display:inline;">
                            <input type="hidden" name="_method" value="DELETE"/>
                            <button type="submit"
                                    class="icon-btn delete-btn"
                                    title="Delete"
                                    onclick="return confirm('Are you sure you want to delete this customer?')">
                                <i class="fa-solid fa-trash"></i>
                            </button>
                        </form>
                    </div>
                </td>
            </tr>
            </tbody>
        </table>
    </div>

</div>

<!-- Modal Add Customer -->
<div id="customerModal" class="modal">
    <div class="modal-content">
        <div class="modal-top">
            <h2>Add New Customer</h2>
            <span class="close" onclick="closeForm()">&times;</span>
        </div>

        <form th:action="@{/rentify/customer/save}" method="post">
            <div class="form-group">
                <label>Customer Name</label>
                <input type="text" name="name" placeholder="Enter customer name" required>
            </div>

            <div class="form-group">
                <label>Phone Number</label>
                <input type="number" name="phone" placeholder="Enter phone number" required>
            </div>

            <div class="form-group">
                <label>Driving License No</label>
                <input type="text" name="drivingLicenseNo" placeholder="Enter license number" required>
            </div>

            <div class="modal-actions">
                <button type="button" class="btn btn-secondary" onclick="closeForm()">Cancel</button>
                <button type="submit" class="btn btn-primary">Save Customer</button>
            </div>
        </form>
    </div>
</div>

<script>
    function openForm() {
        document.getElementById("customerModal").style.display = "block";
    }

    function closeForm() {
        document.getElementById("customerModal").style.display = "none";
    }

    // Close modal when click outside
    window.onclick = function(event) {
        let modal = document.getElementById("customerModal");
        if (event.target === modal) {
            closeForm();
        }
    }

    // Live Search Filter
    function filterTable() {
        let input = document.getElementById("searchInput").value.toLowerCase();
        let table = document.getElementById("customerTable");
        let rows = table.getElementsByTagName("tr");

        for (let i = 1; i < rows.length; i++) {
            let rowText = rows[i].innerText.toLowerCase();
            rows[i].style.display = rowText.includes(input) ? "" : "none";
        }
    }
</script>

</body>
</html>
