<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <title>Rentify | Bookings</title>

    <!-- Font Awesome -->
    <link rel="stylesheet"
          href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css"/>

    <!-- Google Font -->
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700&display=swap" rel="stylesheet"/>

    <style>
        *{margin:0;padding:0;box-sizing:border-box;font-family:'Poppins',sans-serif}
        body{background:#f4f6fb;padding:20px;color:#2c3e50}

        .navbar{
            background:linear-gradient(135deg,#2c3e50,#34495e);
            color:#fff;padding:15px 20px;border-radius:15px;
            display:flex;justify-content:space-between;align-items:center;
            box-shadow:0 4px 15px rgba(0,0,0,.15);margin-bottom:25px
        }

        .logo{display:flex;align-items:center;gap:10px}
        .app-logo{width:58px;height:58px;border-radius:16px}

        .navbar a{color:#fff;text-decoration:none;font-weight:600}
        .navbar a:hover{color:#f1c40f}

        .page-title h1{font-size:26px}
        .page-title p{color:#6c7a89;margin-top:6px}

        .top-bar{
            display:flex;justify-content:space-between;align-items:center;
            margin:20px 0;flex-wrap:wrap;gap:10px
        }

        .btn{
            padding:10px 16px;border:none;border-radius:12px;
            cursor:pointer;font-weight:600;display:flex;
            align-items:center;gap:8px
        }

        .btn-book{background:#3498db;color:#fff}
        .btn-rent{background:#27ae60;color:#fff}
        .btn-return{background:#f39c12;color:#fff}

        .table-container{
            background:#fff;border-radius:18px;overflow:hidden;
            box-shadow:0 4px 15px rgba(0,0,0,.08)
        }

        table{width:100%;border-collapse:collapse}
        th,td{padding:14px 12px;text-align:center;font-size:14px}
        th{background:#2c3e50;color:#fff}
        tr:hover{background:#f1f1f1}
        td{border-bottom:1px solid #eee}

        .actions{display:flex;justify-content:center;gap:8px}

        .btn-edit{
            background:#e3f2fd;color:#1565c0;
            padding:8px 12px;border-radius:10px;
            text-decoration:none;font-weight:700
        }

        .btn-delete{
            background:#ffe6e6;color:#c0392b;
            padding:8px 12px;border-radius:10px;
            border:none;cursor:pointer;font-weight:700
        }

        .btn-small{
            padding:8px 12px;border-radius:10px;
            text-decoration:none;font-weight:700;color:#fff
        }

        .rent{background:#27ae60}
        .return{background:#f39c12}

        .badge{
            padding:6px 10px;border-radius:10px;
            font-size:12px;font-weight:700
        }

        .SCHEDULED{background:#d4edda;color:#155724}
        .RENTED{background:#fff3cd;color:#856404}
        .RETURNED{background:#f8d7da;color:#721c24}

        @media(max-width:768px){
            table,thead,tbody,th,td,tr{display:block;width:100%}
            thead{display:none}
            tr{margin:12px 0;background:#fff;padding:15px;border-radius:15px}
            td{display:flex;justify-content:space-between}
            td::before{content:attr(data-label);font-weight:700}
        }
    </style>
</head>

<body>

<!-- Navbar -->
<div class="navbar">
    <div class="logo">
        <img th:src="@{/images/rentify.png}" class="app-logo">
        <h2>Rentify</h2>
    </div>
    <div>
        <a href="/rentify/">üè† Dashboard</a>
        &nbsp;
        <a href="/rentify/car/">üöó Cars</a>
    </div>
</div>

<!-- Page Title -->
<div class="page-title">
    <h1>Bookings üßæ</h1>
    <p>Book, Rent and Return cars from one place</p>
</div>

<!-- Alerts -->
<div th:if="${success}" class="alert success">
    <i class="fa-solid fa-circle-check"></i>
    <span th:text="${success}"></span>
</div>

<div th:if="${error}" class="alert error">
    <i class="fa-solid fa-triangle-exclamation"></i>
    <span th:text="${error}"></span>
</div>

<!-- Top Buttons (ALWAYS VISIBLE) -->
<div class="top-bar">
    <button class="btn btn-book" onclick="location.href='/rentify/booking/new'">
        üöó Rent Car
    </button>

</div>

<!-- Table -->
<div class="table-container">
    <table>
        <thead>
        <tr>
            <th>ID</th>
            <th>Start</th>
            <th>End</th>
            <th>Amount</th>
            <th>Status</th>
            <th>Customer</th>
            <th>Car</th>
            <th>Payment</th>
            <th>Action</th>
        </tr>
        </thead>

        <tbody>
        <tr th:each="b : ${bookings}">
            <td data-label="ID" th:text="${b.id}"></td>
            <td data-label="Start" th:text="${b.startDate}"></td>
            <td data-label="End" th:text="${b.endDate}"></td>
            <td data-label="Amount" th:text="${b.totalAmount}"></td>

            <td data-label="Status">
        <span class="badge"
              th:classappend="${b.status}"
              th:text="${b.status}">
        </span>
            </td>

            <td data-label="Customer">
                <a th:if="${b.customer != null}"
                   th:text="${b.customer.name}"
                   th:href="@{/rentify/customer/find/{id}(id=${b.customer.id})}"
                   style="color:#1e88e5; text-decoration:none; font-weight:600;">
                </a>

                <span th:if="${b.customer == null}">N/A</span>
            </td>
            <td data-label="Car">
                <a th:if="${b.car != null}"
                   th:text="${b.car.registrationNo}"
                   th:href="@{/rentify/car/find/{id}(id=${b.car.id})}"
                   style="color:#1e88e5; text-decoration:none; font-weight:600;">
                </a>

                <span th:if="${b.car == null}">N/A</span>
            </td>

            <td data-label="Payment">
                <a th:if="${b.payment != null}"
                   th:text="${b.payment.id}"
                   th:href="@{/rentify/payment/find/{id}(id=${b.payment.id})}"
                   style="color:#1e88e5; text-decoration:none; font-weight:600;">
                </a>

                <span th:if="${b.payment == null}">N/A</span>
            </td>


            <!-- Actions -->
            <td data-label="Action" class="actions">

                <!-- Edit (backend allows only SCHEDULED) -->
                <a th:href="@{/rentify/booking/edit/{id}(id=${b.id})}"
                   class="btn-edit">‚úèÔ∏è</a>

                <!-- Delete -->
                <form th:action="@{/rentify/booking/delete/{id}(id=${b.id})}"
                      method="post"
                      onsubmit="return confirm('Delete booking?');">
                    <input type="hidden" name="_method" value="DELETE"/>
                    <button class="btn-delete">üóë</button>
                </form>


            </td>
        </tr>
        </tbody>
    </table>
</div>

</body>
</html>
